{"ast":null,"code":"// Initialize Firebase \nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\nconst config = {\n  apiKey: \"AIzaSyDWT1HRjJ-p0jH5pjQPtWLSVuZ2xxyWIDU\",\n  authDomain: \"hfac-sc.firebaseapp.com\",\n  databaseURL: \"https://hfac-sc.firebaseio.com\",\n  projectId: \"hfac-sc\",\n  storageBucket: \"hfac-sc.appspot.com\",\n  messagingSenderId: \"432119133740\"\n};\n\nfunction parseString(inStr) {\n  var ret = inStr.replace(/\\./g, \"+\");\n  ret = ret.replace(/#/g, \"+\");\n  ret = ret.replace(/\\$/g, \"+\");\n  ret = ret.replace(/\\[/g, \"+\");\n  ret = ret.replace(/\\]/g, \"+\");\n  return ret;\n}\n\nfunction revertParse(inStr) {\n  return inStr.replace(/\\+/g, \".\");\n}\n\nfunction findAdmin(toFind, func) {\n  // function that finds user in the database, returning an object isAdmin\n  // isAdmin is a bool that states if this account is a verified admin able to view the page\n  var db = firebase.database().ref();\n  const query = '/admins/' + parseString(toFind.email);\n  console.log(\"database query: \" + query);\n  db.child(query).once('value').then(function (snapshot) {\n    if (snapshot.exists()) {\n      func(toFind, true);\n    } else {\n      alert(\"Signed in email is not an admin, contact system admin if this is incorrect\");\n      firebase.auth().signOut();\n    }\n  });\n  return;\n}\n\nclass Firebase {\n  constructor() {\n    firebase.initializeApp(config);\n    console.log(\"firebase intialized\");\n  }\n\n  doSignIn(cleanUpFunc) {\n    //signs in user if a user is not signed in already\n    var a = firebase.auth();\n\n    if (a.currentUser == null) {\n      console.log(\"signing in\");\n      var provider = new firebase.auth.GoogleAuthProvider();\n      var user = a.signInWithPopup(provider);\n      user.then(function (result) {\n        findAdmin({\n          email: result.user.email,\n          name: result.user.displayName\n        }, cleanUpFunc);\n      }) //error code that warns user of potential mishaps\n      .catch(function (error) {\n        var errorCode = error.code;\n\n        if (errorCode === \"auth/popup-closed-by-user\") {\n          console.log(\"Sign in window closed by user before finalizing authentication\");\n        } else {\n          alert(error);\n        }\n      });\n    } else {\n      console.log(\"user already signed in\");\n      this.checkStatus(cleanUpFunc);\n    }\n  }\n\n  doSignOut(cleanUpFunc) {\n    var a = firebase.auth();\n\n    if (a.currentUser != null) {\n      a.signOut();\n      cleanUpFunc();\n      console.log(\"signed out\");\n    }\n  }\n\n  doSearch(inObj, statusBind) // searches the database for inObj.type value for all items that contain .substr\n  //    when a match is found, inObj.updateListBind(match) is called\n  // Sets the status log by calling statusBind\n  {\n    var db = firebase.database().ref();\n    var path = \"/\" + parseString(inObj.type) + \"s/\";\n    db.child(path).once('value').then(function (snapshot) {\n      if (!snapshot.exists()) {\n        //statusBind(\"Could not search \" + inObj.type + \"s as they do not exist in the database\");\n        return;\n      }\n\n      inObj.updateListBind(\"\", inObj.type, true);\n      snapshot.forEach(function (secondSnap) {\n        const subString = inObj.substr.toLowerCase();\n        const entry = revertParse(\"\" + secondSnap.key);\n        const lowered = entry.toLowerCase();\n\n        if (lowered.includes(subString)) {\n          inObj.updateListBind(entry, inObj.type);\n        }\n      });\n    });\n  }\n\n  doAddHelper(refs, reduxBind = () => {}) {\n    //Attemps to add an object to the database\n    //recieves an object with attributes type, adding, statusFunc, then adds these to the\n    //    database to the corresponding values\n    var db = firebase.database().ref();\n    const parsedStr = parseString(refs.adding);\n    const query = '/' + refs.type + 's/' + parsedStr;\n    db.child(query).once('value').then(function (snapshot) {\n      if (snapshot.exists()) {\n        refs.statusFunc(\"Failed to add \" + refs.type + \" \" + refs.adding + \"\\n REASON: \" + refs.type + \" already exists in database\");\n      } else {\n        var updates = {};\n        updates[query] = true;\n        db.update(updates);\n        reduxBind();\n        refs.statusFunc(\"Successfully added \" + refs.type + \" \" + refs.adding);\n        return;\n      }\n    }).catch(function (error) {\n      alert(\"An error occurred: \", error);\n      refs.statusFunc(\"Failed to add \" + refs.type + \" \" + refs.adding + \" REASON: \" + error);\n    });\n  }\n\n  doDeleteHelper(refs, reduxBind = () => {}) {\n    //Attemps to delete an user to the database\n    var db = firebase.database().ref();\n    const parsedStr = parseString(refs.deleting);\n    const query = '/' + refs.type + 's/' + parsedStr;\n    db.child(query).once('value').then(function (snapshot) {\n      if (snapshot.exists()) {\n        var confirmStr = \"are you sure you want to delete the \" + refs.type + \" \" + refs.deleting + \"?\";\n\n        if (window.confirm(confirmStr)) {\n          db.child(query).remove();\n          reduxBind();\n          refs.statusFunc(\"Successfully deleted \" + refs.type + \" \" + refs.deleting);\n        } else {\n          refs.statusFunc(\"Deletion of \" + refs.type + \" \" + refs.deleting + \" aborted by user\");\n        }\n\n        return;\n      } else {\n        alert(\"This \" + refs.type + \" does not exist in the database\");\n        refs.statusFunc(refs.type + \" \" + refs.deleting + \" does not exist in database\");\n      }\n    }).catch(function (error) {\n      alert(\"An error occurred: \", error);\n      refs.statusFunc(\"Failed to delete \" + refs.type + \" \" + refs.deleting + \"/n REASON: \" + error);\n    });\n  }\n\n  doAddAdmin(adminToAdd, statusBind) {\n    //Attemps to add an admin to the database\n    var obj = {\n      type: \"admin\",\n      adding: adminToAdd,\n      statusFunc: statusBind\n    };\n    this.doAddHelper(obj);\n  }\n\n  doDeleteAdmin(adminToDel, statusBind) {\n    //Attemps to delete an admin to the database\n    var obj = {\n      type: \"admin\",\n      deleting: adminToDel,\n      statusFunc: statusBind\n    };\n    this.doDeleteHelper(obj);\n  }\n\n  doAddUser(userToAdd, statusBind) {\n    var obj = {\n      type: \"user\",\n      adding: userToAdd,\n      statusFunc: statusBind\n    };\n    this.doAddHelper(obj);\n  }\n\n  doDeleteUser(userToDel, statusBind) {\n    var obj = {\n      type: \"user\",\n      deleting: userToDel,\n      statusFunc: statusBind\n    };\n    this.doDeleteHelper(obj);\n  }\n\n  doAddResponse(responseToAdd, statusBind) {\n    var obj = {\n      type: \"response\",\n      adding: responseToAdd,\n      statusFunc: statusBind\n    };\n    this.doAddHelper(obj);\n  }\n\n  doDeleteResponse(responseToDel, statusBind) {\n    var obj = {\n      type: \"response\",\n      deleting: responseToDel,\n      statusFunc: statusBind\n    };\n    this.doDeleteHelper(obj);\n  }\n\n  doAddIssue(issueToAdd, statusBind) {\n    var obj = {\n      type: \"issue\",\n      adding: issueToAdd,\n      statusFunc: statusBind\n    };\n    this.doAddHelper(obj);\n  }\n\n  doDeleteIssue(issueToDel, statusBind) {\n    var obj = {\n      type: \"issue\",\n      deleting: issueToDel,\n      statusFunc: statusBind\n    };\n    this.doDeleteHelper(obj);\n  }\n\n  doAddProgram(programToAdd, statusBind) {\n    var obj = {\n      type: \"program\",\n      adding: programToAdd,\n      statusFunc: statusBind\n    };\n    this.doAddHelper(obj);\n  }\n\n  doDeleteProgram(programToDel, statusBind) {\n    var obj = {\n      type: \"program\",\n      deleting: programToDel,\n      statusFunc: statusBind\n    };\n    this.doDeleteHelper(obj);\n  }\n\n  checkStatus(signInFunc) {\n    var a = firebase.auth();\n\n    if (a.currentUser != null) {\n      console.log(\"CheckStatus says: user signed in\");\n      signInFunc({\n        email: a.currentUser.email,\n        name: a.currentUser.displayName\n      }, true);\n    } else {\n      console.log(\"CheckStatus says: no user signed in\");\n    }\n  }\n\n  test() {\n    console.log(\"working\");\n  }\n\n}\n\nexport default Firebase;","map":{"version":3,"sources":["/Users/dloyd/summer_sc/ShelterCareAdminPort/src/components/firebase/app.js"],"names":["firebase","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","parseString","inStr","ret","replace","revertParse","findAdmin","toFind","func","db","database","ref","query","email","console","log","child","once","then","snapshot","exists","alert","auth","signOut","Firebase","constructor","initializeApp","doSignIn","cleanUpFunc","a","currentUser","provider","GoogleAuthProvider","user","signInWithPopup","result","name","displayName","catch","error","errorCode","code","checkStatus","doSignOut","doSearch","inObj","statusBind","path","type","updateListBind","forEach","secondSnap","subString","substr","toLowerCase","entry","key","lowered","includes","doAddHelper","refs","reduxBind","parsedStr","adding","statusFunc","updates","update","doDeleteHelper","deleting","confirmStr","window","confirm","remove","doAddAdmin","adminToAdd","obj","doDeleteAdmin","adminToDel","doAddUser","userToAdd","doDeleteUser","userToDel","doAddResponse","responseToAdd","doDeleteResponse","responseToDel","doAddIssue","issueToAdd","doDeleteIssue","issueToDel","doAddProgram","programToAdd","doDeleteProgram","programToDel","signInFunc","test"],"mappings":"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","sourcesContent":["// Initialize Firebase \nimport firebase from 'firebase/app'; \nimport 'firebase/auth';\nimport 'firebase/database';\n  const config = {\n    apiKey: \"AIzaSyDWT1HRjJ-p0jH5pjQPtWLSVuZ2xxyWIDU\",\n    authDomain: \"hfac-sc.firebaseapp.com\",\n    databaseURL: \"https://hfac-sc.firebaseio.com\",\n    projectId: \"hfac-sc\",\n    storageBucket: \"hfac-sc.appspot.com\",\n    messagingSenderId: \"432119133740\"\n  };\n  function parseString(inStr)\n  {\n    var ret = inStr.replace(/\\./g, \"+\");\n    ret = ret.replace(/#/g, \"+\");\n    ret = ret.replace(/\\$/g, \"+\");\n    ret = ret.replace(/\\[/g, \"+\");\n    ret = ret.replace(/\\]/g, \"+\");\n    return ret; \n  }\n  function revertParse(inStr)\n  {\n    return inStr.replace(/\\+/g, \".\");\n  }\n  function findAdmin(toFind, func)\n    {\n      // function that finds user in the database, returning an object isAdmin\n      // isAdmin is a bool that states if this account is a verified admin able to view the page\n      var db = firebase.database().ref();\n      const query = '/admins/'+parseString(toFind.email);\n      console.log(\"database query: \"+query);\n\n      db.child(query).once('value').then(function(snapshot) {\n        if(snapshot.exists())\n        {\n          func(toFind, true);\n        }\n        else\n        {\n          alert(\"Signed in email is not an admin, contact system admin if this is incorrect\");\n          firebase.auth().signOut();  \n        }\n      });\n      return ;\n    }\n    \n  \n  class Firebase{\n    constructor(){\n      firebase.initializeApp(config);\n      console.log(\"firebase intialized\");\n    }\n    doSignIn(cleanUpFunc) {\n      //signs in user if a user is not signed in already\n      var a = firebase.auth();\n      if(a.currentUser == null)\n      {\n        console.log(\"signing in\");\n        var provider = new firebase.auth.GoogleAuthProvider();\n        var user = a.signInWithPopup(provider);\n\n        user.then(function(result)\n        {\n          findAdmin({email:result.user.email, name:result.user.displayName}, cleanUpFunc)\n        })\n        //error code that warns user of potential mishaps\n        .catch(function(error)\n        {\n         var errorCode = error.code;\n         if (errorCode === \"auth/popup-closed-by-user\")\n          {\n            console.log(\"Sign in window closed by user before finalizing authentication\");\n          }\n          else\n          {\n            alert(error);\n          }\n        });\n      }\n      else\n      {\n        console.log(\"user already signed in\");\n        this.checkStatus(cleanUpFunc);\n      }\n    }\n    doSignOut(cleanUpFunc){\n      var a = firebase.auth();\n      if(a.currentUser != null)\n      {\n        a.signOut();\n        cleanUpFunc();\n        console.log(\"signed out\");\n      }\n    }\n    doSearch(inObj, statusBind)\n    // searches the database for inObj.type value for all items that contain .substr\n    //    when a match is found, inObj.updateListBind(match) is called\n    // Sets the status log by calling statusBind\n    {\n      var db = firebase.database().ref();\n      var path = \"/\"+parseString(inObj.type)+\"s/\";\n      db.child(path).once('value').then(function(snapshot){\n        if(!snapshot.exists())\n        {\n          //statusBind(\"Could not search \" + inObj.type + \"s as they do not exist in the database\");\n          return ;\n        }\n        inObj.updateListBind(\"\", inObj.type, true);\n        snapshot.forEach(function(secondSnap){\n          const subString = inObj.substr.toLowerCase();\n          const entry = revertParse(\"\" + secondSnap.key);\n          const lowered = entry.toLowerCase();\n          if(lowered.includes(subString))\n          {\n            inObj.updateListBind(entry, inObj.type);\n          }\n        });\n        \n      });\n    }\n    doAddHelper(refs, reduxBind = () => {})\n    {\n      //Attemps to add an object to the database\n      //recieves an object with attributes type, adding, statusFunc, then adds these to the\n      //    database to the corresponding values\n      var db = firebase.database().ref();\n      const parsedStr = parseString(refs.adding);\n      const query = '/'+refs.type+'s/'+parsedStr;\n\n      db.child(query).once('value').then(function(snapshot) {\n        if(snapshot.exists())\n        {\n          refs.statusFunc(\"Failed to add \"+ refs.type+\" \" + refs.adding +\"\\n REASON: \"+ refs.type+\" already exists in database\");\n        }\n        else\n        {\n          var updates = {};\n          updates[query] = true;\n          db.update(updates);\n          reduxBind();\n          refs.statusFunc(\"Successfully added \"+ refs.type+\" \" + refs.adding);\n          return ;\n        }\n      })\n      .catch(function(error) {\n        alert(\"An error occurred: \", error);\n        refs.statusFunc(\"Failed to add \"+ refs.type+\" \" + refs.adding + \" REASON: \" +error);\n      });\n    }\n    doDeleteHelper(refs, reduxBind = () => {})\n    {\n      //Attemps to delete an user to the database\n      var db = firebase.database().ref();\n      const parsedStr = parseString(refs.deleting);\n      const query = '/'+refs.type+'s/'+parsedStr;\n\n      db.child(query).once('value').then(function(snapshot) {\n        if(snapshot.exists())\n        {\n          var confirmStr = \"are you sure you want to delete the \"+refs.type+ \" \"+ refs.deleting + \"?\";\n          if(window.confirm(confirmStr))\n          {\n            db.child(query).remove();\n            reduxBind();\n            refs.statusFunc(\"Successfully deleted \"+refs.type+ \" \"+ refs.deleting);\n          }\n          else\n          {\n            refs.statusFunc(\"Deletion of \"+refs.type+ \" \"+ refs.deleting +\" aborted by user\");\n          }\n          return ;\n        }\n        else\n        {\n          alert(\"This \"+refs.type+ \" does not exist in the database\");\n          refs.statusFunc(refs.type+ \" \" + refs.deleting +\" does not exist in database\");\n        }\n      })\n      .catch(function(error) {\n        alert(\"An error occurred: \", error);\n        refs.statusFunc(\"Failed to delete \"+refs.type+ \" \"+ refs.deleting+\"/n REASON: \" +error);\n      });\n    }\n    doAddAdmin(adminToAdd, statusBind)\n    {\n      //Attemps to add an admin to the database\n      var obj = {\n        type: \"admin\",\n        adding: adminToAdd,\n        statusFunc: statusBind\n      };\n      this.doAddHelper(obj);\n    }\n    doDeleteAdmin(adminToDel, statusBind)\n    {\n      //Attemps to delete an admin to the database\n      var obj = {\n        type: \"admin\",\n        deleting: adminToDel,\n        statusFunc: statusBind\n      };\n      this.doDeleteHelper(obj);\n    }\n    doAddUser(userToAdd, statusBind)\n    {\n      var obj = {\n        type: \"user\",\n        adding: userToAdd,\n        statusFunc: statusBind\n      };\n      this.doAddHelper(obj);\n    }\n    doDeleteUser(userToDel, statusBind)\n    {\n      var obj = {\n        type: \"user\",\n        deleting: userToDel,\n        statusFunc: statusBind\n      };\n      this.doDeleteHelper(obj);\n    }\n    doAddResponse(responseToAdd, statusBind)\n    {\n      var obj = {\n        type: \"response\",\n        adding: responseToAdd,\n        statusFunc: statusBind\n      };\n      this.doAddHelper(obj);\n    }\n    doDeleteResponse(responseToDel, statusBind)\n    {\n      var obj = {\n        type: \"response\",\n        deleting: responseToDel,\n        statusFunc: statusBind\n      };\n      this.doDeleteHelper(obj);\n    }\n    doAddIssue(issueToAdd, statusBind)\n    {\n      var obj = {\n        type: \"issue\",\n        adding: issueToAdd,\n        statusFunc: statusBind\n      };\n      this.doAddHelper(obj);\n    }\n    doDeleteIssue(issueToDel, statusBind)\n    {\n      var obj = {\n        type: \"issue\",\n        deleting: issueToDel,\n        statusFunc: statusBind\n      };\n      this.doDeleteHelper(obj);\n    }\n    doAddProgram(programToAdd, statusBind)\n    {\n      var obj = {\n        type: \"program\",\n        adding: programToAdd,\n        statusFunc: statusBind\n      };\n      this.doAddHelper(obj);\n    }\n    doDeleteProgram(programToDel, statusBind)\n    {\n      var obj = {\n        type: \"program\",\n        deleting: programToDel,\n        statusFunc: statusBind\n      };\n      this.doDeleteHelper(obj);\n    }\n    checkStatus(signInFunc){\n      var a = firebase.auth();\n      if(a.currentUser != null)\n      {\n        console.log(\"CheckStatus says: user signed in\");\n        signInFunc({email: a.currentUser.email, name:a.currentUser.displayName},true)\n      }\n      else\n      {\n        console.log(\"CheckStatus says: no user signed in\");\n      }\n    }\n    test()\n    {\n      console.log(\"working\");\n    }\n  }\n\n  export default Firebase;\n"]},"metadata":{},"sourceType":"module"}